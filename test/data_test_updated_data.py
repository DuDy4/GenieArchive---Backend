import sys
import os

sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), "..")))

from common.events.genie_event import GenieEvent
from common.events.topics import Topic


def test_new_contact():
    asaf_person = """{"uuid": "e58a0044-c276-4c1c-a63e-5a57d79ccb8b", "name": "Asaf Savich", "company": "GenieAI", "email": "asaf@trywonder.ai", "linkedin": "https://www.linkedin.com/in/asaf-savich/", "position": "CTO", "timezone": ""}"""
    personal_data = """{"id": "bov1GRExBWshHHlV1L0Qqg_0000", "full_name": "asaf savich", "first_name": "asaf", "last_initial": "s", "last_name": "savich", "sex": "male", "linkedin_url": "linkedin.com/in/asaf-savich", "linkedin_username": "asaf-savich", "industry": "computer software", "job_title": "director of engineering", "job_title_role": "engineering", "job_title_levels": ["director"], "job_company_name": "kubiya.ai", "job_company_website": "kubiya.ai", "job_company_size": "11-50", "job_last_changed": "2024-03-21", "job_last_verified": "2024-03-25", "job_last_updated": "2024-03-25", "job_start_date": "2023-04", "location_name": "israel", "location_country": "israel", "location_continent": "asia", "location_last_updated": "2024-03-25", "phone_numbers": [], "emails": [{"address": "asaf.savich@whitesourcesoftware.com", "type": "professional"}, {"address": "asaf@safedk.com", "type": "professional"}], "interests": [], "skills": ["java", "software development", "c#", "android development", "oop", "c", "object oriented design", "html", "android", "programming", "object oriented programming", "software quality assurance", "quality center", "test automation", "test execution", "integration testing", "testing", "hp quality center", "mobile applications", "manual testing", "regression testing", "software design"], "location_names": [], "regions": [], "countries": ["israel"], "street_addresses": [], "experience": [{"company": {"name": "kubiya.ai", "size": "11-50", "linkedin_url": "linkedin.com/company/kubiya", "linkedin_id": "86714205", "facebook_url": "", "twitter_url": "", "website": "kubiya.ai"}, "location_names": [], "end_date": "", "start_date": "2023-04", "title": {"name": "director of engineering", "role": "engineering", "sub_role": "", "levels": ["director"]}, "is_primary": true}, {"company": {"name": "mend.io", "size": "201-500", "id": "fCAGFPoo1SLGXQTTwY5C3wgs0352", "founded": 2011, "industry": "computer software", "linkedin_url": "linkedin.com/company/mend-io", "linkedin_id": "2440656", "facebook_url": "facebook.com/whitesource", "twitter_url": "twitter.com/whtsrc", "website": "mend.io"}, "end_date": "2023-04", "start_date": "2020-12", "title": {"name": "research and development director", "role": "education", "sub_role": "researcher", "levels": ["director"]}, "is_primary": false}, {"company": {"name": "vaica", "size": "11-50", "id": "FvpuOYdoBnUCvDvKNju7VA2uSy8T", "founded": 2007, "industry": "medical devices", "linkedin_url": "linkedin.com/company/vaica", "linkedin_id": "10535016", "facebook_url": "", "twitter_url": "twitter.com/vaicamed", "website": "vaica.com"}, "location_names": [], "end_date": "2016-06", "start_date": "2015-11", "title": {"name": "software engineer", "role": "engineering", "sub_role": "software", "levels": []}, "is_primary": false}, {"company": {"name": "mend.io", "size": "201-500", "founded": 2011, "industry": "computer software", "linkedin_url": "linkedin.com/company/mend-io", "linkedin_id": "2440656", "facebook_url": "facebook.com/whitesource", "twitter_url": "twitter.com/whtsrc", "website": "mend.io"}, "location_names": [], "end_date": "2017-11", "start_date": "2016-07", "title": {"name": "software engineer", "role": "engineering", "sub_role": "software", "levels": []}, "is_primary": false}, {"company": {"name": "mend.io", "size": "201-500", "id": "fCAGFPoo1SLGXQTTwY5C3wgs0352", "founded": 2011, "industry": "computer software", "location": {"name": "boston, massachusetts, united states", "locality": "boston", "region": "massachusetts", "metro": "boston, massachusetts", "country": "united states", "continent": "north america", "street_address": "33 arch street", "address_line_2": "suite 1700", "postal_code": "02110", "geo": "42.35,-71.06"}, "linkedin_url": "linkedin.com/company/mend-io", "linkedin_id": "2440656", "facebook_url": "facebook.com/whitesource", "twitter_url": "twitter.com/whtsrc", "website": "mend.io"}, "location_names": [], "end_date": "2018-12", "start_date": "2017-11", "title": {"name": "lead software engineer", "role": "engineering", "sub_role": "software", "levels": ["manager"]}, "is_primary": false}, {"company": {"name": "safedk", "size": "11-50", "id": "pCJbcWmseUwbuCred97V6QR7VYw2", "founded": 2014, "industry": "computer software", "location": "", "linkedin_url": "linkedin.com/company/safedk", "linkedin_id": "4863891", "facebook_url": "facebook.com/safedk", "twitter_url": "twitter.com/getsafedk", "website": "safedk.com"}, "location_names": [], "end_date": "2015-09", "start_date": "2015-01", "title": {"name": "research and development intern", "role": "education", "sub_role": "researcher", "levels": ["training"]}, "is_primary": false}, {"company": {"name": "test direct (now qualitest)", "size": "51-200", "id": "9ZXFkTN0LvXA0FywHESCUAqBRPVs", "founded": 2002, "industry": "information technology and services", "location": {"name": "preston, lancashire, united kingdom", "locality": "preston", "region": "lancashire", "metro": "", "country": "united kingdom", "continent": "europe", "street_address": "", "address_line_2": "", "postal_code": "", "geo": "53.76,-2.71"}, "linkedin_url": "linkedin.com/company/qualitest-group", "linkedin_id": "155573", "facebook_url": "facebook.com/qualitest-group-297508626937610", "twitter_url": "", "website": "test-direct.com"}, "location_names": ["netanya, hamerkaz, israel"], "end_date": "2013-04", "start_date": "2010-01", "title": {"name": "software testing", "role": "engineering", "sub_role": "software", "levels": []}, "is_primary": false}, {"company": {"name": "mend.io", "size": "201-500", "id": "fCAGFPoo1SLGXQTTwY5C3wgs0352", "founded": 2011, "industry": "computer software"}, "location_names": [], "end_date": "2020-12", "start_date": "2018-12", "title": {"name": "backend team leader", "role": "", "sub_role": "", "levels": ["manager"]}, "is_primary": false}], "education": [{"school": {"name": "idc herzliya", "type": "post-secondary institution", "id": "CTl9f93u6aDYpit4J-8GEQ_0", "location": {"name": "israel", "country": "israel", "locality": "", "continent": "asia", "region": ""}, "linkedin_url": "linkedin.com/school/business-data-analytics-idc-herzliya", "facebook_url": "facebook.com/idc.herzliya", "twitter_url": "twitter.com/idcherzliya", "linkedin_id": "78275112", "website": "idc.ac.il", "domain": "idc.ac.il"}, "degrees": ["bachelors", "bachelor of science"], "start_date": "2010", "end_date": "2012", "majors": [], "minors": [], "gpa": ""}, {"school": {"name": "idc herzliya", "type": "post-secondary institution", "id": "CTl9f93u6aDYpit4J-8GEQ_0", "location": {"name": "israel", "country": "israel", "locality": "", "continent": "asia", "region": ""}, "linkedin_url": "linkedin.com/school/business-data-analytics-idc-herzliya", "facebook_url": "facebook.com/idc.herzliya", "twitter_url": "twitter.com/idcherzliya", "linkedin_id": "78275112", "website": "idc.ac.il", "domain": "idc.ac.il"}, "degrees": ["bachelors", "bachelor of arts", "bachelor of science"], "start_date": "2013", "end_date": "2016", "majors": [], "minors": [], "gpa": ""}], "profiles": [{"network": "linkedin", "id": "276091652", "url": "linkedin.com/in/asaf-savich", "username": "asaf-savich"}, {"network": "linkedin", "id": "276091652", "url": "linkedin.com/in/asaf-savich-31856778", "username": "asaf-savich-31856778"}], "version_status": {"status": "", "contains": [], "previous_version": "", "current_version": ""}}"""
    data_to_send = {"person": asaf_person, "response": personal_data}
    event = GenieEvent(
        topic=Topic.UPDATED_ENRICHED_DATA, data=data_to_send, scope="public"
    )
    event.send()


test_new_contact()
